1.ŞEHİRLERE GÖRE VERİLEN SİPARİŞLERİ TOPLAM OLARAK LİSTEMELE

SELECT 
	C.CITY AS SEHIRADI,
	SUM(OO.LINETOTAL) AS TOPLAMSIPARISTUTARI,
	SUM(OO.AMOUNT) AS TOPLAMSIPARISADEDI,
	COUNT(OO.ID) AS TOPLAMSIPARISSAYISI
FROM ORDERS O
	INNER JOIN USERS U ON U.ID = O.USERID
	INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
	INNER JOIN CITIES C ON C.ID =A.CITYID
	INNER JOIN TOWNS T ON T.ID = A.TOWNID
	INNER JOIN DISTRICTS D ON D.ID = A.DISTRICTID
	INNER JOIN PAYMENTS P ON P.ORDERID = O.ID
	INNER JOIN INVOICES I ON I.ORDERID = O.ID
	INNER JOIN ORDERDETAILS OO ON OO.ORDERID = O.ID
	INNER JOIN ITEMS ITM ON ITM.ID = OO.ITEMID
GROUP BY C.CITY
ORDER BY C.CITY

-------------------------------------------------------------------------------------

2.ÜRÜN KATEGORİLERİNE GÖRE SİPARİŞ DAĞILIMI

SELECT 
	ITM.CATEGORY1,
	SUM(OO.LINETOTAL) AS TOPLAMSIPARISTUTARI,
	SUM(OO.AMOUNT) AS TOPLAMSIPARISADEDI,
	COUNT(OO.ID) AS TOPLAMSIPARISSAYISI,
	SUM(OO.LINETOTAL) / SUM(OO.AMOUNT) AS ORTALAMABIRIMFIYAT
FROM ORDERS O
	INNER JOIN USERS U ON U.ID = O.USERID
	INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
	INNER JOIN CITIES C ON C.ID =A.CITYID
	INNER JOIN TOWNS T ON T.ID = A.TOWNID
	INNER JOIN DISTRICTS D ON D.ID = A.DISTRICTID
	INNER JOIN PAYMENTS P ON P.ORDERID = O.ID
	INNER JOIN INVOICES I ON I.ORDERID = O.ID
	INNER JOIN ORDERDETAILS OO ON OO.ORDERID = O.ID
	INNER JOIN ITEMS ITM ON ITM.ID = OO.ITEMID
GROUP BY ITM.CATEGORY1
ORDER BY 1 DESC